# 01-06. IPv4 주소 체계와 클래스

> CCNA 200-301 수준의 네트워크 엔지니어 면접 시나리오입니다.
> IPv4 주소 구조, 클래스 A/B/C, 사설 IP 범위(RFC 1918), 루프백 주소, 기본 게이트웨이, 특수 주소 등을 다룹니다.

---

### 면접관: "IPv4 주소의 구조를 설명해 주세요. 네트워크 부분과 호스트 부분은 어떻게 구분하나요?"

IPv4 주소는 **32비트** 길이로, 사람이 읽기 쉽게 8비트씩 4개의 옥텟(Octet)으로 나누어 십진수로 표기합니다. 이를 **점분 십진 표기법(Dotted Decimal Notation)**이라고 합니다.

```
IPv4 주소 예시: 192.168.1.100

이진수 표현:
11000000 . 10101000 . 00000001 . 01100100
|--옥텟1--|--옥텟2--|--옥텟3--|--옥텟4--|

각 옥텟: 0~255 범위 (8비트 = 2^8 = 256가지)
전체: 32비트 = 약 43억 개의 주소 (2^32 = 4,294,967,296)
```

**네트워크 부분과 호스트 부분의 구분:**

IPv4 주소는 **네트워크 부분(Network Portion)**과 **호스트 부분(Host Portion)**으로 나뉩니다. 이 구분은 **서브넷 마스크**에 의해 결정됩니다.

```
IP 주소:     192.168.1.100
서브넷 마스크: 255.255.255.0  (/24)

이진수:
IP:   11000000.10101000.00000001.01100100
Mask: 11111111.11111111.11111111.00000000
      |------- 네트워크 부분 ------|호스트|

네트워크 주소: 192.168.1.0  (AND 연산 결과)
호스트 번호:   .100
```

- **네트워크 부분**: 서브넷 마스크에서 1인 비트에 해당하는 부분. 같은 네트워크에 속한 장비들은 이 부분이 동일합니다.
- **호스트 부분**: 서브넷 마스크에서 0인 비트에 해당하는 부분. 같은 네트워크 내에서 각 장비를 구분합니다.

같은 네트워크에 있는 장비들은 라우터 없이 직접 통신할 수 있고, 다른 네트워크에 있는 장비와 통신하려면 라우터(기본 게이트웨이)가 필요합니다.

---

### 면접관: "IPv4 주소 클래스(Class A, B, C)에 대해 설명해 주세요. 각 클래스의 범위와 기본 서브넷 마스크를 알려주세요."

IPv4 주소는 전통적으로 5개의 클래스(A~E)로 분류됩니다. 이를 **클래스풀(Classful) 주소 체계**라고 합니다.

| 클래스 | 첫 옥텟 범위 | 첫 비트 패턴 | 기본 서브넷 마스크 | 네트워크 수 | 호스트 수/네트워크 | 용도 |
|--------|-------------|------------|-------------------|-----------|-------------------|------|
| **A** | 1~126 | 0xxxxxxx | 255.0.0.0 (/8) | 126 | 16,777,214 | 대규모 네트워크 |
| **B** | 128~191 | 10xxxxxx | 255.255.0.0 (/16) | 16,384 | 65,534 | 중규모 네트워크 |
| **C** | 192~223 | 110xxxxx | 255.255.255.0 (/24) | 2,097,152 | 254 | 소규모 네트워크 |
| **D** | 224~239 | 1110xxxx | - | - | - | 멀티캐스트 |
| **E** | 240~255 | 1111xxxx | - | - | - | 실험/예약 |

**Class A 예시:**
```
IP: 10.0.0.1
기본 마스크: 255.0.0.0 (/8)
네트워크 부분: 10
호스트 부분:   0.0.1
→ 하나의 네트워크에 약 1,677만 개의 호스트 가능
```

**Class B 예시:**
```
IP: 172.16.0.1
기본 마스크: 255.255.0.0 (/16)
네트워크 부분: 172.16
호스트 부분:   0.1
→ 하나의 네트워크에 약 65,534개의 호스트 가능
```

**Class C 예시:**
```
IP: 192.168.1.1
기본 마스크: 255.255.255.0 (/24)
네트워크 부분: 192.168.1
호스트 부분:   1
→ 하나의 네트워크에 254개의 호스트 가능
```

**참고:** 첫 옥텟이 127인 범위(127.0.0.0~127.255.255.255)는 Class A에서 제외되며, 루프백 주소로 예약되어 있습니다. 또한 현재는 CIDR(Classless Inter-Domain Routing) 방식을 사용하여 클래스에 관계없이 유연하게 서브넷을 지정할 수 있습니다.

---

### 면접관: "사설 IP 주소(Private IP)와 공인 IP 주소(Public IP)의 차이를 설명해 주세요. 사설 IP 범위도 말씀해 주세요."

**공인 IP (Public IP):**
- 인터넷에서 고유하게 사용되는 IP 주소입니다.
- ISP(인터넷 서비스 제공자)로부터 할당받습니다.
- 전 세계적으로 유일하며, 인터넷을 통해 직접 라우팅됩니다.

**사설 IP (Private IP):**
- 내부 네트워크(LAN)에서만 사용되는 IP 주소입니다.
- RFC 1918에 정의되어 있으며, 인터넷에서는 라우팅되지 않습니다.
- 여러 조직이 동일한 사설 IP 범위를 사용할 수 있습니다.
- 인터넷 접속 시 NAT(Network Address Translation)를 통해 공인 IP로 변환됩니다.

#### RFC 1918 사설 IP 주소 범위

| 클래스 | 사설 IP 범위 | CIDR 표기 | 네트워크 수 | 호스트 수 |
|--------|------------|-----------|-----------|----------|
| A | 10.0.0.0 ~ 10.255.255.255 | 10.0.0.0/8 | 1개 | 16,777,214 |
| B | 172.16.0.0 ~ 172.31.255.255 | 172.16.0.0/12 | 16개 | 1,048,574 |
| C | 192.168.0.0 ~ 192.168.255.255 | 192.168.0.0/16 | 256개 | 65,534 |

**사설 IP를 사용하는 이유:**

1. **IPv4 주소 부족 해결**: 약 43억 개의 IPv4 주소로는 전 세계 모든 장비에 공인 IP를 부여하기 어렵습니다. 사설 IP를 사용하면 내부적으로 원하는 만큼 IP를 할당할 수 있습니다.

2. **보안**: 사설 IP는 인터넷에서 직접 접근할 수 없으므로, 외부 공격으로부터 내부 네트워크를 보호합니다.

3. **비용 절감**: 공인 IP는 유료이지만, 사설 IP는 무료로 사용할 수 있습니다.

```
! NAT 기본 설정 예시
Router(config)# interface GigabitEthernet0/0
Router(config-if)# ip nat inside

Router(config)# interface GigabitEthernet0/1
Router(config-if)# ip nat outside

Router(config)# ip nat inside source list 1 interface GigabitEthernet0/1 overload
Router(config)# access-list 1 permit 192.168.1.0 0.0.0.255
```

---

### 면접관: "특수 IP 주소들에 대해 설명해 주세요. 0.0.0.0, 127.0.0.1, 255.255.255.255 같은 주소의 의미가 무엇인가요?"

IPv4에는 특수한 목적으로 예약된 주소들이 있습니다.

| 주소 | 이름 | 용도 | 설명 |
|------|------|------|------|
| **0.0.0.0** | 기본 경로 / 미지정 | 라우팅, DHCP | 기본 경로(Default Route) 또는 IP 미설정 상태 |
| **127.0.0.0/8** | 루프백 | 자기 자신 테스트 | 127.0.0.1이 가장 일반적 |
| **255.255.255.255** | 제한된 브로드캐스트 | 로컬 브로드캐스트 | 같은 네트워크의 모든 장비에게 전송 |
| **네트워크.255** | 서브넷 브로드캐스트 | 서브넷 브로드캐스트 | 해당 서브넷 내 모든 장비에게 전송 |
| **169.254.0.0/16** | APIPA / Link-Local | 자동 설정 | DHCP 실패 시 자동 할당 |

#### 각 특수 주소 상세 설명

**0.0.0.0:**
- 라우팅 테이블에서 기본 경로(Default Route)를 나타냅니다.
- DHCP 클라이언트가 IP를 받기 전 자신의 출발지 주소로 사용합니다.

```
! 기본 경로 설정
Router(config)# ip route 0.0.0.0 0.0.0.0 10.0.0.1

Router# show ip route
S*    0.0.0.0/0 [1/0] via 10.0.0.1
```

**127.0.0.1 (Loopback):**
- 자기 자신을 가리키는 주소입니다.
- TCP/IP 스택이 정상 동작하는지 테스트할 때 사용합니다.
- 이 주소로 보낸 패킷은 네트워크로 나가지 않고 자신에게 돌아옵니다.

```
C:\> ping 127.0.0.1
Reply from 127.0.0.1: bytes=32 time<1ms TTL=128
→ TCP/IP 스택이 정상적으로 동작하는 것을 확인
```

**255.255.255.255 (Limited Broadcast):**
- 같은 로컬 네트워크의 모든 장비에게 전송됩니다.
- 라우터는 이 브로드캐스트를 다른 네트워크로 전달하지 않습니다.
- DHCP Discover 메시지가 이 주소를 사용합니다.

**169.254.x.x (APIPA):**
- DHCP 서버에서 IP를 받지 못했을 때 Windows/Mac이 자동으로 할당하는 주소입니다.
- 이 주소가 보이면 DHCP 관련 문제를 의심해야 합니다.

```
C:\> ipconfig
IPv4 Address. . . . . . . : 169.254.100.50
→ DHCP 서버에서 IP를 받지 못한 상태!

# 트러블슈팅:
# 1. DHCP 서버 동작 확인
# 2. 네트워크 연결 확인
# 3. DHCP relay 설정 확인 (다른 서브넷인 경우)
```

---

### 면접관: "기본 게이트웨이(Default Gateway)란 무엇이고, 왜 필요한가요?"

기본 게이트웨이는 호스트가 자신의 로컬 네트워크 외부로 통신할 때 패킷을 보내는 **첫 번째 라우터의 IP 주소**입니다.

**기본 게이트웨이가 필요한 이유:**

호스트는 목적지 IP가 같은 네트워크에 있으면 직접 통신하지만, 다른 네트워크에 있으면 직접 통신할 수 없습니다. 이때 패킷을 기본 게이트웨이(라우터)로 보내면, 라우터가 라우팅 테이블을 참조하여 적절한 네트워크로 전달합니다.

```
PC의 네트워크 설정:
  IP 주소:        192.168.1.10
  서브넷 마스크:    255.255.255.0
  기본 게이트웨이:  192.168.1.1   ← 이 네트워크에 연결된 라우터의 IP

통신 판단 과정:
  목적지: 192.168.1.20 → 같은 네트워크 → 직접 통신 (ARP 후 전송)
  목적지: 10.0.0.100   → 다른 네트워크 → 게이트웨이(192.168.1.1)로 전송
```

#### 기본 게이트웨이 미설정 시 문제

```
C:\> ping 192.168.1.20     ← 같은 네트워크 → 성공
Reply from 192.168.1.20: bytes=32 time<1ms TTL=128

C:\> ping 10.0.0.100       ← 다른 네트워크 → 실패
Destination host unreachable.
→ 기본 게이트웨이가 없으면 외부 네트워크로 통신 불가!
```

#### 게이트웨이 설정 및 확인

```
! PC에서 확인
C:\> ipconfig
Default Gateway . . . . . : 192.168.1.1

! 라우터에서 게이트웨이 인터페이스 설정
Router(config)# interface GigabitEthernet0/0
Router(config-if)# ip address 192.168.1.1 255.255.255.0
Router(config-if)# no shutdown
```

기본 게이트웨이는 보통 서브넷의 첫 번째(.1) 또는 마지막(.254) 사용 가능 IP를 할당하는 것이 관례입니다.

---

### 면접관: "IPv4 주소에서 네트워크 주소와 브로드캐스트 주소를 빠르게 구하는 방법을 알려주세요. 예를 들어, 172.16.50.100/20의 네트워크 주소와 브로드캐스트 주소를 구해 보세요."

이 문제는 면접에서 자주 나오는 유형이므로 체계적으로 풀어보겠습니다.

**주어진 정보:**
- IP 주소: 172.16.50.100
- 서브넷 마스크: /20 = 255.255.240.0

**풀이 과정:**

```
/20 서브넷 마스크 분석:
255.255.240.0
       ^^^
       240 = 11110000 (세 번째 옥텟에서 서브넷이 나뉨)

블록 크기 = 256 - 240 = 16 (세 번째 옥텟 기준)
```

**세 번째 옥텟에서 서브넷 경계 찾기:**
```
블록 크기 16으로 나열: 0, 16, 32, 48, 64, ...

50은 48과 64 사이에 있으므로:
- 네트워크 주소:   172.16.48.0    (48에서 시작)
- 브로드캐스트:    172.16.63.255  (64 - 1 = 63, 호스트 비트 전부 1)
- 호스트 범위:     172.16.48.1 ~ 172.16.63.254
```

**검증:**
```
이진수 AND 연산:
IP:   172.16. 00110010 .100  (50 = 00110010)
Mask: 255.255.11110000 .0

AND:  172.16. 00110000 .0    (48 = 00110000)
→ 네트워크 주소: 172.16.48.0 ✓

호스트 수: 2^12 - 2 = 4094개 (호스트 비트 12개)
```

#### 빠른 계산을 위한 핵심 정리

```
/20 → 세 번째 옥텟에서 240 → 블록 16
/21 → 세 번째 옥텟에서 248 → 블록 8
/22 → 세 번째 옥텟에서 252 → 블록 4
/23 → 세 번째 옥텟에서 254 → 블록 2
/24 → 세 번째 옥텟에서 256(=0) → 블록 1 (= 네 번째 옥텟 전체)
```

이처럼 서브넷 경계가 어느 옥텟에서 나뉘는지 파악하고, 블록 크기를 이용하면 빠르게 계산할 수 있습니다.

---

### 면접관: "마지막으로, 멀티캐스트 주소와 브로드캐스트의 차이를 설명해 주세요."

**브로드캐스트(Broadcast):**
- 같은 네트워크(서브넷) 내의 **모든 장비**에게 전송합니다.
- L2 목적지 MAC: FF:FF:FF:FF:FF:FF
- L3 목적지 IP: 255.255.255.255 (제한된 브로드캐스트) 또는 서브넷 브로드캐스트 주소
- 라우터를 넘어가지 않습니다 (라우터가 브로드캐스트를 차단).
- 해당 네트워크의 모든 장비가 패킷을 처리해야 하므로, 네트워크 규모가 커지면 부담이 됩니다.

**멀티캐스트(Multicast):**
- **특정 그룹에 가입한 장비**에게만 전송합니다.
- Class D 주소 범위 (224.0.0.0 ~ 239.255.255.255) 사용
- 그룹에 가입하지 않은 장비는 패킷을 무시합니다.
- 네트워크 효율이 높습니다 (필요한 장비에게만 전달).

| 항목 | 유니캐스트 | 브로드캐스트 | 멀티캐스트 |
|------|----------|------------|----------|
| 수신자 | 1개 | 모든 장비 | 그룹 가입 장비 |
| IP 범위 | 일반 IP | 255.255.255.255 등 | 224.0.0.0~239.255.255.255 |
| 라우터 통과 | 가능 | 불가 | 가능 (설정 시) |
| 효율 | 높음 (1:1) | 낮음 (모두 처리) | 중간 (필요한 곳만) |

**대표적인 멀티캐스트 주소:**

| 주소 | 용도 |
|------|------|
| 224.0.0.1 | 서브넷의 모든 호스트 |
| 224.0.0.2 | 서브넷의 모든 라우터 |
| 224.0.0.5 | OSPF 라우터 |
| 224.0.0.6 | OSPF DR/BDR |
| 224.0.0.9 | RIPv2 라우터 |
| 224.0.0.10 | EIGRP 라우터 |

멀티캐스트는 IPTV, 화상 회의, 라우팅 프로토콜 업데이트 등 하나의 소스가 다수의 수신자에게 동일한 데이터를 보내야 할 때 효율적으로 사용됩니다.
