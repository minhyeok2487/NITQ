# 01-01. OSI 7계층과 TCP/IP 모델

> CCNA 200-301 수준의 네트워크 엔지니어 면접 시나리오입니다.
> OSI 7계층 모델과 TCP/IP 4계층 모델의 구조, 각 계층별 역할, 캡슐화/역캡슐화, PDU 명칭, 실무 트러블슈팅 관점을 다룹니다.

---

### 면접관: "네트워크 엔지니어로서 OSI 7계층 모델을 설명해 주세요. 각 계층의 역할과 대표적인 프로토콜을 포함해서 말씀해 주시면 됩니다."

OSI(Open Systems Interconnection) 7계층 모델은 네트워크 통신을 7개의 계층으로 나누어 설명하는 참조 모델입니다. 아래에서 위로 설명드리겠습니다.

| 계층 | 이름 | 역할 | 대표 프로토콜/장비 | PDU |
|------|------|------|---------------------|-----|
| 7 | 응용 계층 (Application) | 사용자와 직접 상호작용하는 네트워크 서비스 제공 | HTTP, FTP, DNS, SMTP, SSH | Data |
| 6 | 표현 계층 (Presentation) | 데이터 형식 변환, 암호화, 압축 | SSL/TLS, JPEG, ASCII | Data |
| 5 | 세션 계층 (Session) | 세션 설정, 유지, 종료 관리 | NetBIOS, RPC | Data |
| 4 | 전송 계층 (Transport) | 종단 간 신뢰성 있는 전송, 흐름 제어 | TCP, UDP | Segment |
| 3 | 네트워크 계층 (Network) | 논리적 주소 지정, 라우팅 | IP, ICMP, OSPF | Packet |
| 2 | 데이터링크 계층 (Data Link) | 물리적 주소 지정, 프레임 구성, 오류 검출 | Ethernet, ARP, 스위치 | Frame |
| 1 | 물리 계층 (Physical) | 전기 신호, 광 신호 등 물리적 전송 | 케이블, 허브, 리피터 | Bit |

실무에서는 이 계층 모델을 기반으로 장애를 체계적으로 분석합니다. 예를 들어 "핑이 안 된다"는 문제가 발생하면, 1계층(케이블 연결 상태)부터 3계층(라우팅 테이블)까지 순서대로 확인합니다.

---

### 면접관: "그러면 실무에서 더 많이 사용하는 TCP/IP 모델은 어떻게 다른가요? OSI 모델과 비교해서 설명해 주세요."

TCP/IP 모델은 실제 인터넷 통신에서 사용되는 프로토콜 스택을 기반으로 한 4계층 모델입니다. OSI 모델이 이론적 참조 모델이라면, TCP/IP 모델은 실제 구현된 프로토콜 중심의 모델입니다.

| TCP/IP 계층 | 대응하는 OSI 계층 | 주요 프로토콜 |
|-------------|-------------------|---------------|
| 응용 계층 (Application) | 7, 6, 5계층 | HTTP, FTP, DNS, SSH, SMTP |
| 전송 계층 (Transport) | 4계층 | TCP, UDP |
| 인터넷 계층 (Internet) | 3계층 | IP, ICMP, ARP |
| 네트워크 접근 계층 (Network Access) | 2, 1계층 | Ethernet, Wi-Fi |

두 모델의 핵심적인 차이점을 정리하면 다음과 같습니다.

- **OSI 모델**은 7계층으로 세분화되어 있어 학습과 트러블슈팅 시 계층별 분석에 유리합니다.
- **TCP/IP 모델**은 4계층으로 간소화되어 있으며, 실제 프로토콜 구현과 직접 대응됩니다.
- OSI의 5, 6, 7계층이 TCP/IP에서는 하나의 응용 계층으로 통합됩니다.
- OSI의 1, 2계층이 TCP/IP에서는 네트워크 접근 계층으로 통합됩니다.

실무에서 트러블슈팅할 때는 OSI 계층 용어를 사용하여 "L2 문제인지 L3 문제인지"와 같이 소통하는 경우가 많습니다.

---

### 면접관: "캡슐화(Encapsulation)와 역캡슐화(Decapsulation)가 무엇인지 설명하고, 데이터가 전송될 때 각 계층에서 어떤 일이 일어나는지 말씀해 주세요."

캡슐화는 상위 계층에서 하위 계층으로 데이터가 내려가면서 각 계층의 헤더(Header)가 추가되는 과정입니다. 역캡슐화는 그 반대로, 수신 측에서 하위 계층부터 상위 계층으로 올라가면서 헤더를 하나씩 제거하는 과정입니다.

**캡슐화 과정 (송신 측):**

1. **응용 계층**: 사용자 데이터(Data) 생성
2. **전송 계층**: TCP/UDP 헤더 추가 → **Segment** (TCP) 또는 **Datagram** (UDP)
3. **네트워크 계층**: IP 헤더 추가 → **Packet**
4. **데이터링크 계층**: Ethernet 헤더 + 트레일러(FCS) 추가 → **Frame**
5. **물리 계층**: 전기/광 신호로 변환 → **Bit**

각 계층에서 추가되는 헤더에는 해당 계층의 제어 정보가 포함됩니다. 예를 들어 전송 계층 헤더에는 출발지/목적지 포트 번호가, 네트워크 계층 헤더에는 출발지/목적지 IP 주소가, 데이터링크 계층 헤더에는 출발지/목적지 MAC 주소가 포함됩니다.

**역캡슐화 과정 (수신 측):**

수신 측에서는 물리 계층에서 비트를 수신한 후, 각 계층을 올라가면서 해당 계층의 헤더를 확인하고 제거합니다. 최종적으로 응용 계층에서 원래의 데이터를 사용자에게 전달합니다.

---

### 면접관: "실제 업무에서 네트워크 장애가 발생했을 때, OSI 계층별로 어떻게 트러블슈팅하시나요? 구체적인 명령어를 포함해서 설명해 주세요."

네트워크 장애 발생 시 일반적으로 하위 계층부터 상위 계층 순서(Bottom-Up)로 점검합니다.

#### 1계층 (물리 계층) 점검

물리적 연결 상태를 먼저 확인합니다.

```
Switch# show interfaces status
Switch# show interfaces FastEthernet0/1
```

- 인터페이스 상태가 `up/up`인지 확인
- `down/down`이면 케이블 연결 문제, `up/down`이면 프로토콜 불일치 문제
- CRC 에러, Input/Output 에러 카운터 확인

#### 2계층 (데이터링크 계층) 점검

MAC 주소 테이블과 ARP 동작을 확인합니다.

```
Switch# show mac address-table
Router# show arp
```

#### 3계층 (네트워크 계층) 점검

IP 주소 설정, 라우팅 테이블, 연결성을 확인합니다.

```
Router# show ip interface brief
Router# show ip route
Router# ping 10.0.0.1
Router# traceroute 10.0.0.1
```

#### 4계층 이상 점검

포트 연결성과 서비스 동작 여부를 확인합니다.

```
PC> telnet 10.0.0.1 80
PC> netstat -an
```

이렇게 계층별로 체계적으로 점검하면 장애 원인을 빠르게 파악할 수 있습니다.

---

### 면접관: "스위치는 몇 계층 장비이고, 라우터는 몇 계층 장비인가요? 그리고 L3 스위치는 무엇인가요?"

스위치는 기본적으로 **2계층(데이터링크 계층)** 장비입니다. MAC 주소를 기반으로 프레임을 전달하며, MAC 주소 테이블을 학습하고 유지합니다.

라우터는 **3계층(네트워크 계층)** 장비입니다. IP 주소를 기반으로 패킷을 라우팅하며, 라우팅 테이블을 사용하여 최적 경로를 결정합니다.

**L3 스위치**는 스위치의 고속 하드웨어 기반 전환 능력과 라우터의 라우팅 기능을 결합한 장비입니다. 2계층 스위칭과 3계층 라우팅을 모두 수행할 수 있습니다.

```
! L3 스위치에서 VLAN 간 라우팅 설정 예시
Switch(config)# ip routing
Switch(config)# interface vlan 10
Switch(config-if)# ip address 192.168.10.1 255.255.255.0
Switch(config-if)# no shutdown
```

정리하면 다음과 같습니다.

| 장비 | 동작 계층 | 주소 기반 | 주요 기능 |
|------|-----------|-----------|-----------|
| 허브 | 1계층 | 없음 | 신호 증폭, 모든 포트로 전달 |
| 스위치 (L2) | 2계층 | MAC 주소 | 프레임 전환, MAC 학습 |
| L3 스위치 | 2~3계층 | MAC + IP | 스위칭 + 라우팅 |
| 라우터 | 3계층 | IP 주소 | 라우팅, WAN 연결 |

---

### 면접관: "HTTP 요청이 발생했을 때, 데이터가 OSI 각 계층을 통과하는 전체 흐름을 처음부터 끝까지 설명해 보세요."

사용자가 웹 브라우저에서 `http://www.example.com`에 접속하는 시나리오로 설명하겠습니다.

**송신 측 (클라이언트):**

1. **7계층 (응용)**: 브라우저가 HTTP GET 요청 메시지를 생성합니다.
2. **6계층 (표현)**: 필요 시 데이터 인코딩 처리합니다 (HTTPS라면 SSL/TLS 암호화).
3. **5계층 (세션)**: 서버와의 세션을 설정하고 관리합니다.
4. **4계층 (전송)**: TCP 헤더를 추가합니다. 출발지 포트(예: 50000)와 목적지 포트(80)가 포함됩니다. 3-way handshake로 연결을 수립합니다.
5. **3계층 (네트워크)**: IP 헤더를 추가합니다. 출발지 IP(예: 192.168.1.10)와 목적지 IP(예: 93.184.216.34)가 포함됩니다. 라우팅 테이블을 참조하여 다음 홉을 결정합니다.
6. **2계층 (데이터링크)**: Ethernet 헤더와 트레일러를 추가합니다. 출발지 MAC과 다음 홉(게이트웨이)의 MAC 주소가 포함됩니다. 목적지 MAC을 모르면 ARP를 수행합니다.
7. **1계층 (물리)**: 프레임을 전기 신호(UTP) 또는 광 신호(광케이블)로 변환하여 전송합니다.

**수신 측 (서버):**

수신 측에서는 1계층부터 7계층까지 역캡슐화를 수행하며, 각 계층에서 헤더 정보를 확인하고 제거합니다. 최종적으로 7계층에서 HTTP 요청을 처리하고, 응답 데이터를 동일한 캡슐화 과정을 거쳐 클라이언트로 보냅니다.

이 과정에서 중요한 점은 **라우터를 거칠 때마다 2계층 헤더(MAC 주소)는 변경되지만, 3계층 헤더(IP 주소)는 변경되지 않는다**는 것입니다.

---

### 면접관: "마지막으로, PDU(Protocol Data Unit)라는 용어를 정리해 주시고, 각 계층의 PDU 이름이 왜 다른지 설명해 주세요."

PDU(Protocol Data Unit)란 각 계층에서 처리하는 데이터의 단위를 의미합니다. 계층마다 PDU의 이름이 다른 이유는, 각 계층에서 추가하는 제어 정보(헤더)가 다르기 때문입니다.

| 계층 | PDU 명칭 | 포함되는 헤더 정보 |
|------|----------|---------------------|
| 7~5계층 | **Data** | 응용 프로토콜 정보 |
| 4계층 | **Segment** (TCP) / **Datagram** (UDP) | 출발지/목적지 포트, 시퀀스 번호 등 |
| 3계층 | **Packet** | 출발지/목적지 IP, TTL 등 |
| 2계층 | **Frame** | 출발지/목적지 MAC, FCS 등 |
| 1계층 | **Bit** | 전기/광 신호 |

PDU 이름이 다른 이유는 각 계층의 역할과 처리 방식이 다르기 때문입니다.

- **Segment**라고 부르는 이유: 전송 계층에서 큰 데이터를 분할(Segmentation)하여 전송하기 때문입니다.
- **Packet**이라고 부르는 이유: 네트워크 계층에서 논리적 주소(IP)를 패킹(Packing)하여 경로를 결정하기 때문입니다.
- **Frame**이라고 부르는 이유: 데이터링크 계층에서 헤더와 트레일러로 데이터를 프레이밍(Framing)하여 물리적 전송 단위를 만들기 때문입니다.

실무에서 Wireshark 같은 패킷 분석 도구를 사용하면, 이 계층별 헤더 구조를 직접 확인할 수 있습니다.

```
# Wireshark에서 캡처한 패킷 구조 예시
Frame (L2): Dst MAC, Src MAC, EtherType
  └─ Packet (L3): Src IP, Dst IP, TTL, Protocol
      └─ Segment (L4): Src Port, Dst Port, Seq, Ack, Flags
          └─ Data (L7): HTTP GET / HTTP/1.1
```

이러한 계층적 구조를 이해하면 네트워크 장애 시 어느 계층에서 문제가 발생했는지 빠르게 파악할 수 있습니다.
